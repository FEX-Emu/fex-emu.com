<!DOCTYPE html>
<html>
  <head>
    <title>FEX 2112 Tagged! – FEX-Emu – A fast linux usermode x86 and x86-64 emulator</title>

        <meta charset="utf-8" />
    <meta content='text/html; charset=utf-8' http-equiv='Content-Type'>
    <meta http-equiv='X-UA-Compatible' content='IE=edge'>
    <meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1.0'>

    
    <meta name="description" content="A lot of changed things this month.

  New instructions &amp; fixes (BZHI, MULX, RORX, SARX/SHLX/SHRX)
  steamwebhelper now works
  Linux emulation updated to 5.16, sched_getaffinity, MAP_32BIT, 32-bit DRM emulation improvements
  Several other bug fixes and optimizations

" />
    <meta property="og:description" content="A lot of changed things this month.

  New instructions &amp; fixes (BZHI, MULX, RORX, SARX/SHLX/SHRX)
  steamwebhelper now works
  Linux emulation updated to 5.16, sched_getaffinity, MAP_32BIT, 32-bit DRM emulation improvements
  Several other bug fixes and optimizations

" />
    
    <meta name="author" content="FEX-Emu" />

    
    <meta property="og:title" content="FEX 2112 Tagged!" />
    <meta property="twitter:title" content="FEX 2112 Tagged!" />
    

    <!--[if lt IE 9]>
      <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <link rel="stylesheet" type="text/css" href="/style.css" />
    <link rel="alternate" type="application/rss+xml" title="FEX-Emu - A fast linux usermode x86 and x86-64 emulator" href="/feed.xml" />

    <!-- Created with Jekyll Now - http://github.com/barryclark/jekyll-now -->
  </head>

  <body>
    <div class="wrapper-masthead">
      <div class="container">
        <header class="masthead clearfix">
          <a href="/" class="site-avatar"><img src="images/fex-textlogo-140h.png" /></a>

          <nav>
            <a href="/blog">Blog</a>
            <a href="https://github.com/FEX-Emu/FEX">Github</a>
            
              <a href="https://www.twitter.com/FEX_Emu">Twitter</a>
            
            
              <a href="https://discord.gg/fexemu">Discord</a>
            
          </nav>
        </header>
      </div>
    </div>

    <div id="main" role="main" class="container">
      <article class="post">
  <h1>FEX 2112 Tagged!</h1>

  <div class="entry">
    <p>A lot of changed things this month.</p>
<ul>
  <li>New instructions &amp; fixes (BZHI, MULX, RORX, SARX/SHLX/SHRX)</li>
  <li>steamwebhelper now works</li>
  <li>Linux emulation updated to 5.16, sched_getaffinity, MAP_32BIT, 32-bit DRM emulation improvements</li>
  <li>Several other bug fixes and optimizations</li>
</ul>

<h2 id="arm64">Arm64</h2>
<ul>
  <li>Reduce the chance of hanging on reentrant allocations (8ab6830f)</li>
  <li>Adds an inline syscall optimization (f7468703)</li>
  <li>COND_FGT should map to gt, not hi, as it is not FGTU (b45603d1)
    <ul>
      <li>Fixes steamwebhelper burning all CPU cores!</li>
    </ul>
  </li>
</ul>

<h2 id="fexcore">FEXCore</h2>
<ul>
  <li>Fixes CompileService race condition on thread creation (5345f7fa)</li>
  <li>Centralize alignment utility functions in one header (966272ce)</li>
  <li>Fixes ERROR_AND_DIE (fbd14b65)</li>
  <li>Supports guest SIGILL  (6e1ea92c)</li>
  <li>CPUID
    <ul>
      <li>Call handler functions directly (ffee22d3)</li>
    </ul>
  </li>
  <li>OpcodeDispatcher
    <ul>
      <li>Remove debug message (d883b4bf)</li>
      <li>Implement BZHI (50c8d9ed)</li>
      <li>Amend return types of BitSize helpers (c63c5fb6)</li>
      <li>Implement MULX (498a845c)</li>
      <li>Resolve sign mismatches in loops (ad864e0e)</li>
      <li>Add helper for getting bit sizes (3a3cbf2b)</li>
      <li>Handle RORX (51d21d86)</li>
      <li>Implement BMI2 SARX/SHLX/SHRX (e37a0bbd)</li>
      <li>Removes usage of SignalFrame stack on JITs (d81d5e21)</li>
      <li>Use std::vector as the underlying container for std::stack (61ccec37)</li>
      <li>Partial support for RIP adjust in signal handler (77093a7f)</li>
      <li>Resolve unused variable warnings (a04cc4dc)</li>
    </ul>
  </li>
  <li>OpcodeDecoder
    <ul>
      <li>Shorten up GPR and MM base offset retrieval (59ed91c5)</li>
      <li>Convert enums into enum classes where applicable (d1fa8bcf)</li>
      <li>Add support for ADX (d3cd354c)</li>
    </ul>
  </li>
  <li>Frontend
    <ul>
      <li>Handle VEX RXB bits (d47182b6)</li>
      <li>Mark modrm function LUT as static (c6662a46)</li>
    </ul>
  </li>
  <li>GDBStub</li>
  <li>Fixes a few hangs and crashes  (e027b83a)</li>
  <li>Interpreter
    <ul>
      <li>Build op handler table at compile-time (63f9e0b4)</li>
      <li>Mark F80CMP array as static constexpr (13ad5b66)</li>
    </ul>
  </li>
  <li>JIT
    <ul>
      <li>Eliminate redundant jump target map lookups (8ef02783)</li>
      <li>Ensures signals in compileservice JIT space is handled (97e3a364)</li>
    </ul>
  </li>
  <li>JitSymbols
    <ul>
      <li>Make use of fmt (db0740be)</li>
    </ul>
  </li>
  <li>IR
    <ul>
      <li>Make some interface functions accept pointers to const  (8c38f936)</li>
      <li>Convert NodeID into a strong type (b93871ff)</li>
      <li>Add type alias for Node IDs  (1f306d66)</li>
    </ul>
  </li>
  <li>RegisterAllocationPass
    <ul>
      <li>Resolve sign comparison mismatch in CalculateNodeInterference() (597e4e1d)</li>
      <li>Reduce usages of NodeIDs where applicable (19a06519)</li>
    </ul>
  </li>
</ul>

<h2 id="linux">Linux</h2>
<ul>
  <li>Updates syscalls to 5.16 syscalls (c4d05fb8)</li>
  <li>Fixes sched_getaffinity (d5bf6414)</li>
  <li>Fixes MAP_32BIT error case (92ae6ae2)</li>
  <li>Fixes sigprocmask with new and old set being the same address (7bb78912)</li>
  <li>Passthrough 32-bit syscalls that can be (3dc938b8)</li>
  <li>Emulate MAP_32BIT on mmap (081d0169)</li>
  <li>SignalDelegator update signal mask on return from sigsuspend (90511ddd)</li>
  <li>Updates 32-bit DRM emulation (a92233c7)</li>
</ul>

<h2 id="thunks">Thunks</h2>
<ul>
  <li>Fail loudly if thunking is enabled for a library that isn’t installed (b1b61608)</li>
  <li>ThunksDB
    <ul>
      <li>Updates file to include local libs (e0d40dd4)</li>
    </ul>
  </li>
</ul>

<h2 id="tests">Tests</h2>
<ul>
  <li>Enables 32-bit host runner (cabb58ad)</li>
  <li>Minor cleanup (2a894bc1)</li>
  <li>Various thunk library cleanups (3730a428)</li>
</ul>

<h2 id="misc">Misc</h2>
<ul>
  <li>BucketList
    <ul>
      <li>Minor API touchups (baadf0b9)</li>
    </ul>
  </li>
  <li>CMake
    <ul>
      <li>Adds option to enable time-trace compile option (919e2bc3)</li>
    </ul>
  </li>
  <li>CompileService
    <ul>
      <li>Store WorkItem instances as unique_ptr (ef772c3e)</li>
    </ul>
  </li>
  <li>ELFCodeLoader
    <ul>
      <li>Fixes BRK allocation on some ELF loading (b327daf5)</li>
    </ul>
  </li>
  <li>EnumUtils
    <ul>
      <li>Remove shift operators from helper macro (977d92b7)</li>
    </ul>
  </li>
  <li>General
    <ul>
      <li>Migrate logging over to fmt where possible  (513b02fd)</li>
    </ul>
  </li>
  <li>RootFS
    <ul>
      <li>Keep rootfs around while in container (16f1ad46)</li>
    </ul>
  </li>
  <li>IR.json/json_ir_generator: Minor touchups to generated IR utilities (9b43f94f)</li>
  <li>Various packaging improvements (23e583e1)</li>
</ul>

<h2 id="frontend">Frontend</h2>
<ul>
  <li>Adds Socket logger and tool (6c93b6f7)</li>
  <li>FEXLoader
    <ul>
      <li>Change 32-bit memory check error to warning (82ebdf52)</li>
      <li>Print memory map when 32-bit intersect happens (e6d285a7)</li>
    </ul>
  </li>
  <li>Syscalls
    <ul>
      <li>Move construction of syscall name map into GetSyscallName() (0560e9be)</li>
    </ul>
  </li>
</ul>

<p>See the <a href="https://github.com/FEX-Emu/FEX/releases/tag/FEX-2112">2112 Release Notes</a> or the <a href="https://github.com/FEX-Emu/FEX/compare/FEX-2111...FEX-2112">detailed change log</a> in Github.</p>

  </div>

  <div class="date">
    Written on December  5, 2021
  </div>

  
</article>

    </div>

    <div class="wrapper-footer">
      <div class="container">
        <footer class="footer">
          <a href="https://discord.gg/fexemu"><i class="svg-icon discord"></i></a>




<a href="https://github.com/FEX-Emu/FEX"><i class="svg-icon github"></i></a>




<a href="https://www.twitter.com/FEX_Emu"><i class="svg-icon twitter"></i></a>




        </footer>
      </div>
    </div>

    

  </body>
</html>
